---
title: SQL Server to Snowflake Schema Conversion
authors: [sparsh]
tags: [snowflake]
---

Last week, I was asked to migrate one view from the On-premises MS SQL Server to Snowflake. My first approach is to directly copy paste the DDL (Data Definition Language) and as I predicted, it didn't work. But my goal here was to follow TDD (Test Driven Development) - I ran the first version of DDL and Snowflake told me what the error is, I corrected the error and repeated the cycle 6-8 times until the code ran successfully without error and that's how I did the migration. 

Couple of points that I noted down as conversion rules are:

1. Use `LISTAGG` for `STUFF` - you need to left join the tables with LISTAGG for each STUFF statement
2. Remove `[]` brackets
3. Use `IFNULL` for `ISNULL`
4. `CONCAT` works better for appending strings compare to `+`
5. Use `MONTHNAME` for `DATENAME(month,<>)`, same applies for other date cases
6. `CONVERT` doesn't work, you would need to write custom logic for it (sorry, no direct keyword here!)

I am sure there are more rules we can list out here, but in my view, these were the only rules I needed to apply to migrate my view. If I got another opportunity to migrate some more views and find some new rules, I will definitely update this list.

If you already know some rules which are not here, you can mail me at sprsag@gmail.com or directly message in the Recohut's slack channel.

Thanks for your attention, see you soon!