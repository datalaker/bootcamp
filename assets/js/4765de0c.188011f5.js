"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[35924],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>d});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var s=n.createContext({}),p=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(r),d=o,f=u["".concat(s,".").concat(d)]||u[d]||m[d]||a;return r?n.createElement(f,i(i({ref:t},c),{},{components:r})):n.createElement(f,i({ref:t},c))}));function d(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var p=2;p<a;p++)i[p]=r[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},57937:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var n=r(87462),o=(r(67294),r(3905));const a={title:"SQL Server to Snowflake Schema Conversion",authors:["sparsh"],tags:["snowflake"]},i=void 0,l={permalink:"/blog/2022/12/13/sql-to-snowflake-schema-conversion",source:"@site/blog/2022-12-13-sql-to-snowflake-schema-conversion.mdx",title:"SQL Server to Snowflake Schema Conversion",description:"Last week, I was asked to migrate one view from the On-premises MS SQL Server to Snowflake. My first approach is to directly copy paste the DDL (Data Definition Language) and as I predicted, it didn't work. But my goal here was to follow TDD (Test Driven Development) - I ran the first version of DDL and Snowflake told me what the error is, I corrected the error and repeated the cycle 6-8 times until the code ran successfully without error and that's how I did the migration.",date:"2022-12-13T00:00:00.000Z",formattedDate:"December 13, 2022",tags:[{label:"snowflake",permalink:"/blog/tags/snowflake"}],readingTime:1.235,hasTruncateMarker:!1,authors:[{name:"Sparsh Agarwal",title:"Data Scientist & Engineer",url:"https://github.com/sparsh-ai",email:"sprsag@gmail.com",imageURL:"https://github.com/sparsh-ai.png",key:"sparsh"}],frontMatter:{title:"SQL Server to Snowflake Schema Conversion",authors:["sparsh"],tags:["snowflake"]},prevItem:{title:"A/B and Multi-Armed Bandit Tests",permalink:"/blog/2022/12/24/ab-mab-tests"},nextItem:{title:"The Complete Python Course (2022)",permalink:"/blog/2022/12/12/the-complete-python-course-2022"}},s={authorsImageUrls:[void 0]},p=[],c={toc:p};function m(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Last week, I was asked to migrate one view from the On-premises MS SQL Server to Snowflake. My first approach is to directly copy paste the DDL (Data Definition Language) and as I predicted, it didn't work. But my goal here was to follow TDD (Test Driven Development) - I ran the first version of DDL and Snowflake told me what the error is, I corrected the error and repeated the cycle 6-8 times until the code ran successfully without error and that's how I did the migration. "),(0,o.kt)("p",null,"Couple of points that I noted down as conversion rules are:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Use ",(0,o.kt)("inlineCode",{parentName:"li"},"LISTAGG")," for ",(0,o.kt)("inlineCode",{parentName:"li"},"STUFF")," - you need to left join the tables with LISTAGG for each STUFF statement"),(0,o.kt)("li",{parentName:"ol"},"Remove ",(0,o.kt)("inlineCode",{parentName:"li"},"[]")," brackets"),(0,o.kt)("li",{parentName:"ol"},"Use ",(0,o.kt)("inlineCode",{parentName:"li"},"IFNULL")," for ",(0,o.kt)("inlineCode",{parentName:"li"},"ISNULL")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"CONCAT")," works better for appending strings compare to ",(0,o.kt)("inlineCode",{parentName:"li"},"+")),(0,o.kt)("li",{parentName:"ol"},"Use ",(0,o.kt)("inlineCode",{parentName:"li"},"MONTHNAME")," for ",(0,o.kt)("inlineCode",{parentName:"li"},"DATENAME(month,<>)"),", same applies for other date cases"),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"CONVERT")," doesn't work, you would need to write custom logic for it (sorry, no direct keyword here!)")),(0,o.kt)("p",null,"I am sure there are more rules we can list out here, but in my view, these were the only rules I needed to apply to migrate my view. If I got another opportunity to migrate some more views and find some new rules, I will definitely update this list."),(0,o.kt)("p",null,"If you already know some rules which are not here, you can mail me at ",(0,o.kt)("a",{parentName:"p",href:"mailto:sprsag@gmail.com"},"sprsag@gmail.com")," or directly message in the Recohut's slack channel."),(0,o.kt)("p",null,"Thanks for your attention, see you soon!"))}m.isMDXComponent=!0}}]);