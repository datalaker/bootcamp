"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[61983],{3905:(t,e,n)=>{n.d(e,{Zo:()=>c,kt:()=>d});var a=n(67294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},o=Object.keys(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var s=a.createContext({}),u=function(t){var e=a.useContext(s),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},c=function(t){var e=u(t.components);return a.createElement(s.Provider,{value:e},t.children)},p={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},m=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,o=t.originalType,s=t.parentName,c=l(t,["components","mdxType","originalType","parentName"]),m=u(n),d=r,w=m["".concat(s,".").concat(d)]||m[d]||p[d]||o;return n?a.createElement(w,i(i({ref:e},c),{},{components:n})):a.createElement(w,i({ref:e},c))}));function d(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var s in e)hasOwnProperty.call(e,s)&&(l[s]=e[s]);l.originalType=t,l.mdxType="string"==typeof t?t:r,i[1]=l;for(var u=2;u<o;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},87521:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var a=n(87462),r=(n(67294),n(3905));const o={},i="Window Functions",l={unversionedId:"foundations/programming-languages/sql/window-functions",id:"foundations/programming-languages/sql/window-functions",title:"Window Functions",description:"There is no official categorisation of Window Functions but based on the usage, we can briefly categorise them in 3 ways:",source:"@site/docs/01-foundations/04-programming-languages/sql/window-functions.md",sourceDirName:"01-foundations/04-programming-languages/sql",slug:"/foundations/programming-languages/sql/window-functions",permalink:"/docs/foundations/programming-languages/sql/window-functions",draft:!1,tags:[],version:"current",lastUpdatedBy:"sparsh",lastUpdatedAt:1681047270,formattedLastUpdatedAt:"Apr 9, 2023",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"SQL WHERE",permalink:"/docs/foundations/programming-languages/sql/where"},next:{title:"Apache CouchDB",permalink:"/docs/storage/apache-couchdb"}},s={},u=[{value:"Cheat Sheet",id:"cheat-sheet",level:2},{value:"References",id:"references",level:2}],c={toc:u};function p(t){let{components:e,...n}=t;return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"window-functions"},"Window Functions"),(0,r.kt)("p",null,"There is no official categorisation of Window Functions but based on the usage, we can briefly categorise them in 3 ways:"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/62965911/229128540-ad1ebf04-9b0b-490a-ad9a-cd1ec2dfb7a4.png",alt:"1_nf6iu-Jt4XBLefa6Jv6kMQ"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Aggregate Functions")," ","-"," Regular Aggregate Function can be used as a Window Function to calculate aggregations for numeric columns within window partitions such as running total sales, minimum or maximum value within partition etc."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Ranking Functions")," ","-"," These functions return a ranking value for each row in a partition."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Value Functions")," ","-"," These functions are useful for generating simple statistics or time series analysis.")),(0,r.kt)("p",null,"If we need to figure out MIN and MAX values of MSRP for each PRODUCTLINE, then how will the result sets differ for both GROUP BY and PARTITION BY clause:"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/62965911/229129245-e5b2384f-218f-4c00-9dc7-794934d82f27.png",alt:"1_a3yi8-K7JhgXrKNZVAe0dA"})),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://www.mysqltutorial.org/mysql-window-functions/mysql-cume_dist-function/"},"CUME_DIST")),(0,r.kt)("td",{parentName:"tr",align:null},"Calculates the cumulative distribution of a value in a set of values.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://www.mysqltutorial.org/mysql-window-functions/mysql-dense_rank-function/"},"DENSE_RANK")),(0,r.kt)("td",{parentName:"tr",align:null},"Assigns a rank to every row within its partition based on the ",(0,r.kt)("inlineCode",{parentName:"td"},"ORDER BY"),"\xa0clause. It assigns the same rank to the rows with equal values. If two or more rows have the same rank, then there will be no gaps in the sequence of ranked values.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://www.mysqltutorial.org/mysql-window-functions/mysql-first_value-function/"},"FIRST_VALUE")),(0,r.kt)("td",{parentName:"tr",align:null},"Returns the value of the specified expression with respect to the first row in the window frame.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://www.mysqltutorial.org/mysql-window-functions/mysql-lag-function/"},"LAG")),(0,r.kt)("td",{parentName:"tr",align:null},"Returns the value of the Nth row before the current row in a partition.\xa0It returns NULL if no preceding row exists.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://www.mysqltutorial.org/mysql-window-functions/mysql-last_value-function/"},"LAST_VALUE")),(0,r.kt)("td",{parentName:"tr",align:null},"Returns the value of the specified expression with respect to the last row in the window frame.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://www.mysqltutorial.org/mysql-window-functions/mysql-lead-function/"},"LEAD")),(0,r.kt)("td",{parentName:"tr",align:null},"Returns the value of the Nth row after the current row in a partition.\xa0It returns NULL if no subsequent row exists.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://www.mysqltutorial.org/mysql-window-functions/mysql-nth_value-function/"},"NTH_VALUE")),(0,r.kt)("td",{parentName:"tr",align:null},"Returns value of argument from Nth row of the window frame")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://www.mysqltutorial.org/mysql-window-functions/mysql-ntile-function/"},"NTILE")),(0,r.kt)("td",{parentName:"tr",align:null},"Distributes the rows for each window partition into a specified number of ranked groups.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://www.mysqltutorial.org/mysql-window-functions/mysql-percent_rank-function/"},"PERCENT_RANK")),(0,r.kt)("td",{parentName:"tr",align:null},"Calculates the percentile rank of a row in a partition or result set")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://www.mysqltutorial.org/mysql-window-functions/mysql-rank-function/"},"RANK")),(0,r.kt)("td",{parentName:"tr",align:null},"Similar to the ",(0,r.kt)("inlineCode",{parentName:"td"},"DENSE_RANK()"),"\xa0function except that there are gaps in the sequence of ranked values when two or more rows have the same rank.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://www.mysqltutorial.org/mysql-window-functions/mysql-row_number-function/"},"ROW_NUMBER")),(0,r.kt)("td",{parentName:"tr",align:null},"Assigns a sequential integer to every row within its partition")))),(0,r.kt)("p",null,"A window function performs a calculation across a set of table rows that are somehow related to the current row. This is comparable to the type of calculation that can be done with an aggregate function. But unlike regular aggregate functions, use of a window function does not cause rows to become grouped into a single output row \u2014 the rows retain their separate identities. Behind the scenes, the window function is able to access more than just the current row of the query result."),(0,r.kt)("p",null,"If you'd like to narrow the window from the entire dataset to individual groups within the dataset, you can use PARTITION BY to do so."),(0,r.kt)("p",null,"Note: You can't use window functions and standard aggregations in the same query. More specifically, you can't include window functions in a GROUP BY clause."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"The usual suspects: SUM, COUNT, and AVG")),(0,r.kt)("p",null,"When using window functions, you can apply the same aggregates that you would under normal circumstances\u2014SUM, COUNT, and AVG."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"ROW_NUMBER()")),(0,r.kt)("p",null,"ROW_NUMBER() does just what it sounds like\u2014displays the number of a given row. It starts with 1 and numbers the rows according to the ORDER BY part of the window statement. ROW_NUMBER() does not require you to specify a variable within the parentheses."),(0,r.kt)("p",null,"Using the PARTITION BY clause will allow you to begin counting 1 again in each partition. The following query starts the count over again for each terminal:"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"RANK() and DENSE_RANK()")),(0,r.kt)("p",null,"RANK() is slightly different from ROW_NUMBER()."),(0,r.kt)("p",null,"You can also use DENSE_RANK() instead of RANK() depending on your application. Imagine a situation in which three entries have the same value. Using either command, they will all get the same rank."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"NTILE")),(0,r.kt)("p",null,"You can use window functions to identify what percentile (or quartile, or any other subdivision) a given row falls into. The syntax is NTILE(",(0,r.kt)("em",{parentName:"p"},"# of buckets"),"). In this case, ORDER BY determines which column to use to determine the quartiles (or whatever number of 'tiles you specify). For example:"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"LAG and LEAD")),(0,r.kt)("p",null,"It can often be useful to compare rows to preceding or following rows, especially if you've got the data in an order that makes sense. You can use LAG or LEAD to create columns that pull values from other rows\u2014all you need to do is enter which column to pull from and how many rows away you'd like to do the pull. LAG pulls from previous rows and LEAD pulls from following rows."),(0,r.kt)("p",null,"This is especially useful if you want to calculate differences between rows."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Defining a window alias")),(0,r.kt)("p",null,"If you're planning to write several window functions in to the same query, using the same window, you can create an alias."),(0,r.kt)("p",null,"The WINDOW clause, if included, should always come after the WHERE clause."),(0,r.kt)("h2",{id:"cheat-sheet"},"Cheat Sheet"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/62965911/229131678-80b65039-4b10-4fd7-9fcc-34dc59528c8c.jpg",alt:"Window_Functions_Cheat_Sheet_A3 (1)"})),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://learnsql.com/blog/sql-window-functions-cheat-sheet/Window_Functions_Cheat_Sheet_A3.pdf"},"Click here")," for PDF version"),(0,r.kt)("h2",{id:"references"},"References"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"https://www.stratascratch.com/blog/the-ultimate-guide-to-sql-window-functions/"},"The Ultimate Guide to SQL Window Functions")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"https://learnsql.com/blog/sql-window-functions-cheat-sheet/"},"https://learnsql.com/blog/sql-window-functions-cheat-sheet/"))))}p.isMDXComponent=!0}}]);