"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[81241],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),u=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(a),m=n,b=p["".concat(s,".").concat(m)]||p[m]||d[m]||o;return a?r.createElement(b,l(l({ref:t},c),{},{components:a})):r.createElement(b,l({ref:t},c))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,l=new Array(o);l[0]=p;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:n,l[1]=i;for(var u=2;u<o;u++)l[u]=a[u];return r.createElement.apply(null,l)}return r.createElement.apply(null,a)}p.displayName="MDXCreateElement"},90253:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>u});var r=a(87462),n=(a(67294),a(3905));const o={},l="Lambda CSV to Parquet",i={unversionedId:"processing/lab-lambda-csv-parquet/README",id:"processing/lab-lambda-csv-parquet/README",title:"Lambda CSV to Parquet",description:"Create an S3 bucket and IAM user with user-defined policy. Create Lambda layer and lambda function and add the layer to the function. Add S3 trigger for auto-transformation from csv to parquet and query with Glue.",source:"@site/docs/03-processing/lab-lambda-csv-parquet/README.md",sourceDirName:"03-processing/lab-lambda-csv-parquet",slug:"/processing/lab-lambda-csv-parquet/",permalink:"/docs/processing/lab-lambda-csv-parquet/",draft:!1,tags:[],version:"current",lastUpdatedBy:"sparsh",lastUpdatedAt:1681047270,formattedLastUpdatedAt:"Apr 9, 2023",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Real-Time Clickstream Anomaly Detection with Kinesis",permalink:"/docs/processing/lab-kinesis-clickstream-anomaly/"},next:{title:"Lab: Ray AIR Basics",permalink:"/docs/processing/lab-ray-air-basics/"}},s={},u=[{value:"Objective",id:"objective",level:2},{value:"Problem Statement",id:"problem-statement",level:2},{value:"Use Cases",id:"use-cases",level:2},{value:"Architecture Diagram",id:"architecture-diagram",level:2},{value:"What you&#39;ll build",id:"what-youll-build",level:2},{value:"Code",id:"code",level:2}],c={toc:u};function d(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"lambda-csv-to-parquet"},"Lambda CSV to Parquet"),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Create an S3 bucket and IAM user with user-defined policy. Create Lambda layer and lambda function and add the layer to the function. Add S3 trigger for auto-transformation from csv to parquet and query with Glue.")),(0,n.kt)("h2",{id:"objective"},"Objective"),(0,n.kt)("p",null,"Serverless Data Conversion and Loading into Data Lake"),(0,n.kt)("h2",{id:"problem-statement"},"Problem Statement"),(0,n.kt)("p",null,"Prolambda sources its data from Salesforce and the source extraction process stores the raw data into Prolambda's data lake."),(0,n.kt)("p",null,"Currently Prolambda's data engineering team uses a Spark cluster to load that csv by scanning the S3 every few minutes and then converts it into Parquet format using PySpark functions and then saves it back into the data lake's refined layer. Then they run Glue crawler is scheduled to run every 5 mins that picks the latest changes in the source data and update the Glue database."),(0,n.kt)("p",null,"The process is going well but it is costing the company a lot of money because a Spark cluster needs to be active all the time and the glue crawler's DPU units is through the roof which again costs a huge bill."),(0,n.kt)("p",null,"Your goal is to design and develop a data pipeline which solves the same purpose but at a reduced cost."),(0,n.kt)("h2",{id:"use-cases"},"Use Cases"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Design and develop a data pipeline for 1) CSV to Parquet conversion, 2) Glue registry and database update")),(0,n.kt)("h2",{id:"architecture-diagram"},"Architecture Diagram"),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/62965911/214528163-d8ad4bd2-b1b1-4cf4-a530-bc47df2b0710.svg",alt:"arch drawio"})),(0,n.kt)("h2",{id:"what-youll-build"},"What you'll build"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Create an S3 bucket"),(0,n.kt)("li",{parentName:"ul"},"IAM user with user-defined policy"),(0,n.kt)("li",{parentName:"ul"},"Create and Upload ",(0,n.kt)("inlineCode",{parentName:"li"},"AWS Wrangler")," Lambda layer"),(0,n.kt)("li",{parentName:"ul"},"Develop the python function for csv to parquet conversion"),(0,n.kt)("li",{parentName:"ul"},"Python code to update Glue database"),(0,n.kt)("li",{parentName:"ul"},"Add the layer to the function"),(0,n.kt)("li",{parentName:"ul"},"Add trigger in Lambda for automation"),(0,n.kt)("li",{parentName:"ul"},"Query with Athena")),(0,n.kt)("h2",{id:"code"},"Code"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://nbviewer.org/github/sparsh-ai/recohut/blob/main/03-processing/aws-lambda-function/lab-lambda-csv-parquet/01-sa-etl-lambda.ipynb"},(0,n.kt)("img",{parentName:"a",src:"https://img.shields.io/badge/jupyter-notebook-informational?logo=jupyter",alt:null}))))}d.isMDXComponent=!0}}]);