<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-foundations/language/sql/challenges/assignment2/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">SQL Assignment | Recohut Data Bootcamp</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.recohut.com/docs/foundations/language/sql/challenges/assignment2"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="data science, data engineering, data analytics"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SQL Assignment | Recohut Data Bootcamp"><meta data-rh="true" name="description" content="Learning goals"><meta data-rh="true" property="og:description" content="Learning goals"><link data-rh="true" rel="icon" href="/img/branding/favicon-black.svg"><link data-rh="true" rel="canonical" href="https://www.recohut.com/docs/foundations/language/sql/challenges/assignment2"><link data-rh="true" rel="alternate" href="https://www.recohut.com/docs/foundations/language/sql/challenges/assignment2" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.recohut.com/docs/foundations/language/sql/challenges/assignment2" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Recohut Data Bootcamp RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Recohut Data Bootcamp Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B4S1B1ZDTT"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-B4S1B1ZDTT",{})</script><link rel="stylesheet" href="/assets/css/styles.099cbecb.css">
<link rel="preload" href="/assets/js/runtime~main.40c54d56.js" as="script">
<link rel="preload" href="/assets/js/main.dbd2f5fe.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/branding/favicon-color.svg" alt="Recohut Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/branding/favicon-color.svg" alt="Recohut Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Bootcamp</b></a><a class="navbar__item navbar__link" href="/docs/introduction">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/sparsh-ai/recohut" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>SQL Assignment</h1><p><strong>Learning goals</strong></p><ul><li>Perform analysis on data stored in relational and non-relational database systems to power strategic decision-making.</li><li>Learn to determine, create, and execute SQL and NoSQL queries that manipulate and dissect large scale datasets.</li><li>Leveraging the power of SQL commands, functions, and data cleaning methodologies to join, aggregate, and clean tables, as well as complete performance tune analysis to provide strategic business recommendations.</li><li>Execute core SQL commands to define, select, manipulate, control access, aggregate and join data tables.</li><li>Understand when and how to use subqueries, window functions as well as partitions to complete complex tasks.</li><li>Clean data, optimize SQL queries and write select advanced JOINs to enhance analysis performance.</li></ul><p>Following tables has been loaded for you in the shared rds postgres database (database: postgres, schema: default): <code>web_events</code>, <code>sales_reps</code>, <code>region</code>, <code>orders</code>, and <code>accounts</code>.</p><p>Note: Use LIMIT 10 in your answers to limit the output. LIMIT keyword must be the last one.</p><p>You have to write SQL queries to answer the following questions:</p><ol><li>Displays all the data in the occurred_at, account_id, and channel columns of the web_events table.</li><li>Write a query to return the 10 earliest orders in the orders table. Include the id, occurred_at, and total_amt_usd.</li><li>Write a query to return the top 5 orders in terms of largest total_amt_usd. Include the id, account_id, and total_amt_usd.</li><li>Write a query to return the lowest 20 orders in terms of smallest total_amt_usd. Include the id, account_id, and total_amt_usd.</li><li>Write a query that displays the order ID, account ID, and total dollar amount for all the orders, sorted first by the account ID (in ascending order), and then by the total dollar amount (in descending order).</li><li>Write a query that again displays order ID, account ID, and total dollar amount for each order, but this time sorted first by total dollar amount (in descending order), and then by account ID (in ascending order).</li><li>Pulls the first 5 rows and all columns from the orders table that have a dollar amount of gloss_amt_usd greater than or equal to 1000.</li><li>Pulls the first 10 rows and all columns from the orders table that have a total_amt_usd less than 500.</li><li>Filter the accounts table to include the company name, website, and the primary point of contact (primary_poc) just for the Exxon Mobil company in the accounts table.</li><li>Using the orders table Create a column that divides the standard_amt_usd by the standard_qty to find the unit price for standard paper for each order. Limit the results to the first 10 orders, and include the id and account_id fields.</li><li>Write a query that finds the percentage of revenue that comes from poster paper for each order. Limit your calculations to the first 10 orders.</li><li>Use the accounts table to find All the companies whose names start with &#x27;C&#x27;.</li><li>Use the accounts table to find All companies whose names contain the string &#x27;one&#x27; somewhere in the name.</li><li>Use the accounts table to find All companies whose names end with &#x27;s&#x27;.</li><li>Use the accounts table to find the account name, primary_poc, and sales_rep_id for Walmart, Target, and Nordstrom.</li><li>Use the web_events table to find all information regarding individuals who were contacted via the channel of organic or adwords.</li><li>Use the accounts table to find the account name, primary poc, and sales rep id for all stores except Walmart, Target, and Nordstrom.</li><li>Use the web_events table to find all information regarding individuals who were contacted via any method except using organic or adwords methods.</li><li>Use the accounts table to find All the companies whose names do not start with &#x27;C&#x27;.</li><li>All companies whose names do not contain the string &#x27;one&#x27; somewhere in the name.</li><li>All companies whose names do not end with &#x27;s&#x27;.</li><li>Write a query that returns all the orders where the standard_qty is over 1000, the poster_qty is 0, and the gloss_qty is 0.</li><li>Using the accounts table, find all the companies whose names do not start with &#x27;C&#x27; and end with &#x27;s&#x27;.</li><li>Write a query that displays the order date and gloss_qty data for all orders where gloss_qty is between 24 and 29.</li><li>Use the web_events table to find all information regarding individuals who were contacted via the organic or adwords channels, and started their account at any point in 2016, sorted from newest to oldest.</li><li>Find list of orders ids where either gloss_qty or poster_qty is greater than 4000. Only include the id field in the resulting table.</li><li>Write a query that returns a list of orders where the standard_qty is zero and either the gloss_qty or poster_qty is over 1000.</li><li>Find all the company names that start with a &#x27;C&#x27; or &#x27;W&#x27;, and the primary contact contains &#x27;ana&#x27; or &#x27;Ana&#x27;, but it doesn&#x27;t contain &#x27;eana&#x27;.</li><li>Show all the data from the accounts table, and all the data from the orders table.</li><li>Show standard_qty, gloss_qty, and poster_qty from the orders table, and the website and the primary_poc from the accounts table.</li><li>Join all three of these tables - web_events, orders and accounts.</li><li>Provide a table that provides the region for each sales_rep along with their associated accounts. This time only for the Midwest region. Your final table should include three columns: the region name, the sales rep name, and the account name. Sort the accounts alphabetically (A-Z) according to account name.</li><li>Provide a table that provides the region for each sales_rep along with their associated accounts. This time only for accounts where the sales rep has a first name starting with S and in the Midwest region. Your final table should include three columns: the region name, the sales rep name, and the account name. Sort the accounts alphabetically (A-Z) according to account name.</li><li>Find the total amount spent on standard_amt_usd and gloss_amt_usd paper for each order in the orders table. This should give a dollar amount for each order in the table.</li><li>Find the standard_amt_usd per unit of standard_qty paper. Your solution should use both an aggregation and a mathematical operator.</li><li>Each company in the accounts table wants to create an email address for each primary_poc. The email address should be the first name of the primary_poc.last name <a href="mailto:primary_poc@companyname.com" target="_blank" rel="noopener noreferrer">primary_poc@companyname.com</a>.</li><li>You may have noticed that in the previous question some of the company names include spaces, which will certainly not work in an email address. See if you can create an email address that will work by removing all of the spaces in the account name, but otherwise your solution should be just as above. Some helpful documentation is here: <a href="https://www.postgresql.org/docs/8.1/functions-string.html" target="_blank" rel="noopener noreferrer">https://www.postgresql.org/docs/8.1/functions-string.html</a>.</li><li>We would also like to create an initial password, which they will change after their first log in. The first password will be:<ol><li>the first letter of the primary_poc&#x27;s first name (lowercase), then</li><li>the last letter of their first name (lowercase),</li><li>the first letter of their last name (lowercase),</li><li>the last letter of their last name (lowercase),</li><li>the number of letters in their first name,</li><li>the number of letters in their last name, and then</li><li>the name of the company they are working with, all capitalized with no spaces.</li></ol></li><li>Suppose the company wants to assess the performance of all the sales representatives. Each sales representative is assigned to work in a particular region. To make it easier to understand for the HR team, display the concatenated sales<em>reps.id, ‘</em>’ (underscore), and region.name as EMP_ID_REGION for each sales representative.</li><li>From the accounts table, display:<ol><li>the name of the client,</li><li>the coordinate as concatenated (latitude, longitude),</li><li>email id of the primary point of contact as first letter of the primary_poc last letter of the primary_poc@extracted name and domain from the website.</li></ol></li><li>From the web_events table, display the concatenated value of account_id, &#x27;&#x27; , channel, &#x27;&#x27;, count of web events of the particular channel.</li><li>Create a running total of standard_amt_usd (in the orders table) over order time with no date truncation. Your final table should have two columns: one with the amount being added for each new row, and a second with the running total.</li><li>Now, modify your query from the previous question to include partitions. Still create a running total of standard_amt_usd (in the orders table) over order time, but this time, date truncate occurred_at by year and partition by that same year-truncated occurred_at variable. Your final table should have three columns: One with the amount being added for each row, one for the truncated date, and a final column with the running total within each year.</li><li>Show the num events for each day for each channel using the web_events table.</li><li>Show the avg events for each day for each channel using the web_events table.</li><li>Provide the name of the sales_rep in each region with the largest amount of total_amt_usd sales.</li><li>For the region with the largest (sum) of sales total_amt_usd, how many total (count) orders were placed?</li><li>How many accounts had more total purchases than the account name which has bought the most standard_qty paper throughout their lifetime as a customer?</li><li>For the customer that spent the most (in total over their lifetime as a customer) total_amt_usd, how many web_events did they have for each channel?</li><li>What is the lifetime average amount spent in terms of total_amt_usd for the top 10 total spending accounts?</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="scores">Scores<a class="hash-link" href="#scores" title="Direct link to heading">​</a></h2><table><thead><tr><th></th><th>Ideal</th></tr></thead><tbody><tr><td>1</td><td>1</td></tr><tr><td>2</td><td>1</td></tr><tr><td>3</td><td>1</td></tr><tr><td>4</td><td>1</td></tr><tr><td>5</td><td>1</td></tr><tr><td>6</td><td>1</td></tr><tr><td>7</td><td>1</td></tr><tr><td>8</td><td>1</td></tr><tr><td>9</td><td>1</td></tr><tr><td>10</td><td>1</td></tr><tr><td>11</td><td>2</td></tr><tr><td>12</td><td>1</td></tr><tr><td>13</td><td>1</td></tr><tr><td>14</td><td>1</td></tr><tr><td>15</td><td>1</td></tr><tr><td>16</td><td>1</td></tr><tr><td>17</td><td>1</td></tr><tr><td>18</td><td>1</td></tr><tr><td>19</td><td>1</td></tr><tr><td>20</td><td>1</td></tr><tr><td>21</td><td>1</td></tr><tr><td>22</td><td>1</td></tr><tr><td>23</td><td>1</td></tr><tr><td>24</td><td>1</td></tr><tr><td>25</td><td>1</td></tr><tr><td>26</td><td>1</td></tr><tr><td>27</td><td>1</td></tr><tr><td>28</td><td>3</td></tr><tr><td>29</td><td>1</td></tr><tr><td>30</td><td>1</td></tr><tr><td>31</td><td>1</td></tr><tr><td>32</td><td>2</td></tr><tr><td>33</td><td>2</td></tr><tr><td>34</td><td>1</td></tr><tr><td>35</td><td>1</td></tr><tr><td>36</td><td>3</td></tr><tr><td>37</td><td>2</td></tr><tr><td>38</td><td>4</td></tr><tr><td>39</td><td>2</td></tr><tr><td>40</td><td>3</td></tr><tr><td>41</td><td>3</td></tr><tr><td>42</td><td>2</td></tr><tr><td>43</td><td>3</td></tr><tr><td>44</td><td>3</td></tr><tr><td>45</td><td>3</td></tr><tr><td>46</td><td>5</td></tr><tr><td>47</td><td>5</td></tr><tr><td>48</td><td>3</td></tr><tr><td>49</td><td>5</td></tr><tr><td>50</td><td>5</td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-04-14T05:50:44.000Z">Apr 14, 2023</time></b> by <b>sparsh</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#scores" class="table-of-contents__link toc-highlight">Scores</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Bootcamp. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.40c54d56.js"></script>
<script src="/assets/js/main.dbd2f5fe.js"></script>
</body>
</html>