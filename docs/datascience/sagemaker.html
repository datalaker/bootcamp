<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-datascience/sagemaker/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Amazon Sagemaker | Recohut Data Bootcamp</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.recohut.com/docs/datascience/sagemaker"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="data science, data engineering, data analytics"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Amazon Sagemaker | Recohut Data Bootcamp"><meta data-rh="true" name="description" content="Amazon SageMaker helps data scientists and developers to prepare, build, train, and deploy machine learning models quickly by bringing together a broad set of purpose-built capabilities. In this demo, learn about how SageMaker can accelerate machine learning development by way of an example where we build the perfect musical playlist tailored to a user&#x27;s tastes."><meta data-rh="true" property="og:description" content="Amazon SageMaker helps data scientists and developers to prepare, build, train, and deploy machine learning models quickly by bringing together a broad set of purpose-built capabilities. In this demo, learn about how SageMaker can accelerate machine learning development by way of an example where we build the perfect musical playlist tailored to a user&#x27;s tastes."><link data-rh="true" rel="icon" href="/img/branding/favicon-black.svg"><link data-rh="true" rel="canonical" href="https://www.recohut.com/docs/datascience/sagemaker"><link data-rh="true" rel="alternate" href="https://www.recohut.com/docs/datascience/sagemaker" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.recohut.com/docs/datascience/sagemaker" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Recohut Data Bootcamp RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Recohut Data Bootcamp Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B4S1B1ZDTT"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-B4S1B1ZDTT",{})</script><link rel="stylesheet" href="/assets/css/styles.47c7b9d5.css">
<link rel="preload" href="/assets/js/runtime~main.251db5a0.js" as="script">
<link rel="preload" href="/assets/js/main.1462881d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/branding/favicon-color.svg" alt="Recohut Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/branding/favicon-color.svg" alt="Recohut Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Bootcamp</b></a><a class="navbar__item navbar__link" href="/docs/introduction">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/sparsh-ai/recohut" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Amazon Sagemaker</h1><p>Amazon SageMaker helps data scientists and developers to prepare, build, train, and deploy machine learning models quickly by bringing together a broad set of purpose-built capabilities. In this demo, learn about how SageMaker can accelerate machine learning development by way of an example where we build the perfect musical playlist tailored to a user&#x27;s tastes.</p><iframe width="100%" height="480" src="https://www.youtube.com/embed/Qv_Tr_BCFCQ" title="Introduction to Amazon SageMaker" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lab-aws-sagemaker-in-depth">Lab: AWS Sagemaker In-depth<a class="hash-link" href="#lab-aws-sagemaker-in-depth" title="Direct link to heading">​</a></h2><ol><li>Import Data into the S3 Data Lake</li><li>Query the Amazon S3 Data Lake with Amazon Athena</li><li>Query Data with AWS Data Wrangler</li><li>Dive Deep into the Dataset with Athena and SageMaker</li><li>Convert Raw Text to BERT Features using Hugging Face and TensorFlow</li><li>Add Features to SageMaker Feature Store</li><li>Create Experiment and Process Data</li><li>Query The Feature Store</li><li>Show the Experiment Tracking Lineage</li><li>Show Lineage Artifacts For Our Processing Job</li><li>Fine-Tuning a BERT Model and Create a Text Classifier</li><li>Specify Manual Hyper-Parameters</li><li>Load Pretrained BERT Model</li><li>Setup Hyper-Parameters for Classification Layer</li><li>Evaluate Model with Amazon SageMaker Processing Jobs and Scikit-Learn</li><li>Detect Model Bias using smclarify</li><li>Perform A/B Test using REST Endpoints</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lab-managing-machine-learning-workflows-and-deployments">Lab: Managing Machine Learning Workflows and Deployments<a class="hash-link" href="#lab-managing-machine-learning-workflows-and-deployments" title="Direct link to heading">​</a></h2><p><img loading="lazy" src="https://user-images.githubusercontent.com/62965911/224300324-ca77de3c-0adf-4ed0-ac7e-26e15d8e901d.png" alt="workflow-arch" class="img_ev3q"></p><p>We will cover the following recipes in this lab:</p><ol><li>Working with Hugging Face models</li><li>Preparing the prerequisites of a multi-model endpoint deployment</li><li>Hosting multiple models with multi-model endpoints</li><li>Setting up A/B testing on multiple models with production variants</li><li>Preparing the Step Functions execution role</li><li>Managing ML workflows with AWS Step Functions and the Data Science SDK</li><li>Managing ML workflows with SageMaker Pipelines</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lab-music-recommendation-using-amazon-sagemaker">Lab: Music Recommendation using Amazon SageMaker<a class="hash-link" href="#lab-music-recommendation-using-amazon-sagemaker" title="Direct link to heading">​</a></h2><p>Creating the perfect personalized musical playlist with Amazon SageMaker.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/62965911/224300316-8e1b0bd0-a78d-4efd-9389-e86e43713dad.png" alt="musicrec-arch" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lab-automate-medical-diagnosis-using-amazon-sagemaker">Lab: Automate medical diagnosis using Amazon SageMaker<a class="hash-link" href="#lab-automate-medical-diagnosis-using-amazon-sagemaker" title="Direct link to heading">​</a></h2><p>Detecting cancer cells by analyzing medical images using computer vision with Amazon SageMaker.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/62965911/224300300-b99fcfb5-d527-4811-aeaf-4d44d3ad3979.png" alt="medical-diagnosis-output" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lab-end-to-end-workflow-for-auto-claims-fraud-detection-using-amazon-sagemaker">Lab: End-to-end workflow for auto claims fraud detection using Amazon SageMaker<a class="hash-link" href="#lab-end-to-end-workflow-for-auto-claims-fraud-detection-using-amazon-sagemaker" title="Direct link to heading">​</a></h2><p>The purpose of this end-to-end example is to demonstrate how to prepare, train, and deploy a model that detects auto insurance claims.</p><p>&quot;Auto insurance fraud ranges from misrepresenting facts on insurance applications and inflating insurance claims to staging accidents and submitting claim forms for injuries or damage that never occurred, to false reports of stolen vehicles. Fraud accounted for between 15 percent and 17 percent of total claims payments for auto insurance bodily injury in 2012, according to an Insurance Research Council (IRC) study. The study estimated that between $5.6 billion and $7.7 billion was fraudulently added to paid claims for auto insurance bodily injury payments in 2012, compared with a range of $4.3 billion to $5.8 billion in 2002. &quot; source: Insurance Information Institute</p><p>In this example, we will use an auto insurance domain to detect claims that are possibly fraudulent. more precisely we address the use-case: &quot;what is the likelihood that a given auto claim is fraudulent?&quot; , and explore the technical solution.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/62965911/224300286-6e98a323-e4b7-46fc-9c6f-9bda8bd1abef.png" alt="frauddetect-arch" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lab-customer-churn-prediction-with-xgboost">Lab: Customer Churn Prediction with XGBoost<a class="hash-link" href="#lab-customer-churn-prediction-with-xgboost" title="Direct link to heading">​</a></h2><p>Using Gradient Boosted Trees to Predict Mobile Customer Departure</p><p>Losing customers is costly for any business. Identifying unhappy customers early on gives you a chance to offer them incentives to stay. This notebook describes using machine learning (ML) for the automated identification of unhappy customers, also known as customer churn prediction. ML models rarely give perfect predictions though, so this notebook is also about how to incorporate the relative costs of prediction mistakes when determining the financial outcome of using ML.</p><p>We use a familiar example of churn: leaving a mobile phone operator. Seems like one can always find fault with their provider du jour! And if the provider knows that a customer is thinking of leaving, it can offer timely incentives - such as a phone upgrade or perhaps having a new feature activated – and the customer may stick around. Incentives are often much more cost-effective than losing and reacquiring a customer.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lab-recommendation-engine-for-e-commerce-sales">Lab: Recommendation Engine for E-Commerce Sales<a class="hash-link" href="#lab-recommendation-engine-for-e-commerce-sales" title="Direct link to heading">​</a></h2><p>This lab gives an overview of techniques and services offer by SageMaker to build and deploy a personalized recommendation engine.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="solution">Solution<a class="hash-link" href="#solution" title="Direct link to heading">​</a></h2><ol><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/Managing_Machine_Learning_Workflows_and_Deployments.ipynb" target="_blank" rel="noopener noreferrer">Managing Machine Learning Workflows and Deployments</a></li><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/Music_Recommendation_using_Amazon_SageMaker.ipynb" target="_blank" rel="noopener noreferrer">Music Recommendation using Amazon SageMaker</a></li><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/How_to_automate_medical_diagnosis_using_Amazon_SageMaker.ipynb" target="_blank" rel="noopener noreferrer">How to automate medical diagnosis using Amazon SageMaker</a></li><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/End_to_end_workflow_for_auto_claims_fraud_detection_using_Amazon_SageMaker.ipynb" target="_blank" rel="noopener noreferrer">End-to-end workflow for auto claims fraud detection using Amazon SageMaker</a></li><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/SageMaker_3cases.ipynb" target="_blank" rel="noopener noreferrer">Customer Churn Prediction with XGBoost</a></li><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/Recommendation_Engine_for_E_Commerce_Sales.ipynb" target="_blank" rel="noopener noreferrer">Recommendation Engine for E-Commerce Sales</a></li><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/aws-sagemaker-indepth.ipynb" target="_blank" rel="noopener noreferrer">AWS Sagemaker In-depth</a></li><li>AWS Innovate, AI/ML Edition, EMEA (February 2021)</li><li>Various demos on SageMaker Studio <!-- -->[ https://www.youtube.com/playlist?list=PLJgojBtbsuc0MjdtpJPo4g4PL8mMsd2nK ]</li><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/Managing_Machine_Learning_Workflows_and_Deployments.ipynb" target="_blank" rel="noopener noreferrer">Managing Machine Learning Workflows and Deployments</a></li><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/Music_Recommendation_using_Amazon_SageMaker.ipynb" target="_blank" rel="noopener noreferrer">Music Recommendation using Amazon SageMaker</a></li><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/How_to_automate_medical_diagnosis_using_Amazon_SageMaker.ipynb" target="_blank" rel="noopener noreferrer">How to automate medical diagnosis using Amazon SageMaker</a></li><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/End_to_end_workflow_for_auto_claims_fraud_detection_using_Amazon_SageMaker.ipynb" target="_blank" rel="noopener noreferrer">End-to-end workflow for auto claims fraud detection using Amazon SageMaker</a></li><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/SageMaker_3cases.ipynb" target="_blank" rel="noopener noreferrer">Customer Churn Prediction with XGBoost</a></li><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/Recommendation_Engine_for_E_Commerce_Sales.ipynb" target="_blank" rel="noopener noreferrer">Recommendation Engine for E-Commerce Sales</a></li><li><a href="https://nbviewer.org/github/sparsh-ai/notebooks/blob/main/aws-sagemaker-indepth.ipynb" target="_blank" rel="noopener noreferrer">AWS Sagemaker In-depth</a></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># install tree command (helpful in printing folder structures)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt-get install tree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># setup AWS cli</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p ~/.aws &amp;&amp; cp /content/drive/MyDrive/AWS/d01_admin/* ~/.aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 600 ~/.aws/credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install awscli</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># install boto3 and sagemaker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install boto3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install sagemaker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># install dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install pyathena</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install awswrangler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install smclarify</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install sagemaker-experiments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install sagemaker-tensorflow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install smclarify</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># install nlp libs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install transformers</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> boto3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> sagemaker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pyplot </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sagemaker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">estimator </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Estimator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">### global variables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">role </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sagemakerRole&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">base_job_prefix </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sklearn-housing&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">training_instance_type </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ml.m5.xlarge&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">### setup sagemaker session</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sess </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sagemaker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Session</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bucket </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sess</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">default_bucket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">region </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> boto3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Session</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">region_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> boto3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">client</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;sts&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_caller_identity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Account&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">role_arn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;arn:aws:iam::{}:role/{}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">account_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> role</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> boto3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Session</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">client</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">service_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;sagemaker&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> region_name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">region</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> boto3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Session</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">client</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">service_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;s3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> region_name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">region</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-04-09T13:34:30.000Z">Apr 9, 2023</time></b> by <b>sparsh</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#lab-aws-sagemaker-in-depth" class="table-of-contents__link toc-highlight">Lab: AWS Sagemaker In-depth</a></li><li><a href="#lab-managing-machine-learning-workflows-and-deployments" class="table-of-contents__link toc-highlight">Lab: Managing Machine Learning Workflows and Deployments</a></li><li><a href="#lab-music-recommendation-using-amazon-sagemaker" class="table-of-contents__link toc-highlight">Lab: Music Recommendation using Amazon SageMaker</a></li><li><a href="#lab-automate-medical-diagnosis-using-amazon-sagemaker" class="table-of-contents__link toc-highlight">Lab: Automate medical diagnosis using Amazon SageMaker</a></li><li><a href="#lab-end-to-end-workflow-for-auto-claims-fraud-detection-using-amazon-sagemaker" class="table-of-contents__link toc-highlight">Lab: End-to-end workflow for auto claims fraud detection using Amazon SageMaker</a></li><li><a href="#lab-customer-churn-prediction-with-xgboost" class="table-of-contents__link toc-highlight">Lab: Customer Churn Prediction with XGBoost</a></li><li><a href="#lab-recommendation-engine-for-e-commerce-sales" class="table-of-contents__link toc-highlight">Lab: Recommendation Engine for E-Commerce Sales</a></li><li><a href="#solution" class="table-of-contents__link toc-highlight">Solution</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Bootcamp. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.251db5a0.js"></script>
<script src="/assets/js/main.1462881d.js"></script>
</body>
</html>