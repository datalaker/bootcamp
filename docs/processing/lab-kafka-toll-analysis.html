<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-processing/lab-kafka-toll-analysis/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Data Streaming Pipeline with Kafka for livetolldata | Recohut Data Bootcamp</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.recohut.com/docs/processing/lab-kafka-toll-analysis"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="data science, data engineering, data analytics"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Data Streaming Pipeline with Kafka for livetolldata | Recohut Data Bootcamp"><meta data-rh="true" name="description" content="Objective"><meta data-rh="true" property="og:description" content="Objective"><link data-rh="true" rel="icon" href="/img/branding/favicon-black.svg"><link data-rh="true" rel="canonical" href="https://www.recohut.com/docs/processing/lab-kafka-toll-analysis"><link data-rh="true" rel="alternate" href="https://www.recohut.com/docs/processing/lab-kafka-toll-analysis" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.recohut.com/docs/processing/lab-kafka-toll-analysis" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Recohut Data Bootcamp RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Recohut Data Bootcamp Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B4S1B1ZDTT"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-B4S1B1ZDTT",{})</script><link rel="stylesheet" href="/assets/css/styles.47c7b9d5.css">
<link rel="preload" href="/assets/js/runtime~main.251db5a0.js" as="script">
<link rel="preload" href="/assets/js/main.1462881d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/branding/favicon-color.svg" alt="Recohut Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/branding/favicon-color.svg" alt="Recohut Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Bootcamp</b></a><a class="navbar__item navbar__link" href="/docs/introduction">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/sparsh-ai/recohut" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Data Streaming Pipeline with Kafka for livetolldata</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="objective">Objective<a class="hash-link" href="#objective" title="Direct link to heading">​</a></h2><p>In this lab, we will first create a toll database in MySQL, then create a table schema. We will then start the Kafka server and then stream toll data events using Kafka producer. On the other side, we will receive the streaming events using Kafka consumer and write into MySQL database, into the table that we created.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>You are a data engineer at a data analytics consulting company. You have been assigned to a project that aims to de-congest the national highways by analyzing the road traffic data from different toll plazas. As a vehicle passes a toll plaza, the vehicle’s data like <code>vehicle_id</code>, <code>vehicle_type</code>, <code>toll_plaza_id</code> and <code>timestamp</code> are streamed to Kafka. Your job is to create a data pipe line that collects the streaming data and loads it into a database.</p><p>In this assignment you will create a streaming data pipe by performing these steps:</p><ul><li>Start a MySQL Database server.</li><li>Create a table to hold the toll data.</li><li>Start the Kafka server.</li><li>Install the Kafka python driver.</li><li>Install the MySQL python driver.</li><li>Create a topic named toll in kafka.</li><li>Download streaming data generator program.</li><li>Customize the generator program to steam to toll topic.</li><li>Download and customise streaming data consumer.</li><li>Customize the consumer program to write into a MySQL database table.</li><li>Verify that streamed data is being collected in the database table.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prepare-the-lab-environment">Prepare the lab environment<a class="hash-link" href="#prepare-the-lab-environment" title="Direct link to heading">​</a></h2><p>Before you start the assignment, complete the following steps to set up the lab:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Download Kafka</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget https://archive.apache.org/dist/kafka/2.8.0/kafka_2.12-2.8.0.tgz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Extract Kafka</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar -xzf kafka_2.12-2.8.0.tgz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Start MySQL server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start_mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Connect to the mysql server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysql --host=&lt;hostname&gt; --port=3306  --user=&lt;username&gt; --password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Create a database named `tolldata`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># At the &#x27;mysql&gt;&#x27; prompt, run the command below to create the database.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create database tolldata;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Create a table named `livetolldata` with the schema to store the data generated by the traffic simulator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use tolldata;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create table livetolldata(timestamp datetime,vehicle_id int,vehicle_type char(15),toll_plaza_id smallint);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Disconnect from MySQL server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Install the python module `kafka-python` using the pip command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install kafka-python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Install the python module `mysql-connector-python` using the pip command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install mysql-connector-python </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>livetolldata</code> is the table where you would store all the streamed data that comes from kafka. Each row is a record of when a vehicle has passed through a certain toll plaza along with its type and anonymized id.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="assignment">Assignment<a class="hash-link" href="#assignment" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-21---start-zookeeper">Task 2.1 - Start Zookeeper<a class="hash-link" href="#task-21---start-zookeeper" title="Direct link to heading">​</a></h3><p>Start zookeeper server.</p><p>Take a screenshot of the command you run.</p><p>Name the screenshot <code>start_zookeeper.jpg</code>. (Images can be saved with either the .jpg or .png extension.)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-22---start-kafka-server">Task 2.2 - Start Kafka server<a class="hash-link" href="#task-22---start-kafka-server" title="Direct link to heading">​</a></h3><p>Start Kafka server</p><p>Take a screenshot of the command you run.</p><p>Name the screenshot <code>start_kafka.jpg</code>. (Images can be saved with either the .jpg or .png extension.)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-23---create-a-topic-namedtoll">Task 2.3 - Create a topic named <code>toll</code><a class="hash-link" href="#task-23---create-a-topic-namedtoll" title="Direct link to heading">​</a></h3><p>Create a Kakfa topic named <code>toll</code></p><p>Take a screenshot of the command you run.</p><p>Name the screenshot <code>create_toll_topic.jpg</code>. (Images can be saved with either the .jpg or .png extension.)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-24---configure-the-toll-traffic-simulator">Task 2.4 - Configure the Toll Traffic Simulator<a class="hash-link" href="#task-24---configure-the-toll-traffic-simulator" title="Direct link to heading">​</a></h3><p>Open the <code>toll_traffic_generator.py</code> and set the topic to <code>toll</code>.</p><p>Take a screenshot of the task code with the topic clearly visible.</p><p>Name the screenshot <code>configure_simulator.jpg</code>. (Images can be saved with either the .jpg or .png extension.)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-25---run-the-toll-traffic-simulator">Task 2.5 - Run the Toll Traffic Simulator<a class="hash-link" href="#task-25---run-the-toll-traffic-simulator" title="Direct link to heading">​</a></h3><p>Run the <code>toll_traffic_generator.py</code>.</p><p>Take a screenshot of the output of the simulator.</p><p>Name the screenshot <code>simulator_output.jpg</code>. (Images can be saved with either the .jpg or .png extension.)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-26---configurethe-streaming-data-reader">Task 2.6 - Configure the Streaming Data Reader<a class="hash-link" href="#task-26---configurethe-streaming-data-reader" title="Direct link to heading">​</a></h3><p>Open the <code>streaming_data_reader.py</code> and modify the following details so that the program can connect to your mysql server.</p><ol><li><code>TOPIC</code></li><li><code>DATABASE</code></li><li><code>USERNAME</code></li><li><code>PASSWORD</code></li></ol><p>Take a screenshot of the code you modified.</p><p>Name the screenshot <code>streaming_reader_code.jpg</code>. (Images can be saved with either the .jpg or .png extension.)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-27---runthe-streaming-data-reader">Task 2.7 - Run the Streaming Data Reader<a class="hash-link" href="#task-27---runthe-streaming-data-reader" title="Direct link to heading">​</a></h3><p>Run the <code>streaming_data_reader.py</code></p><p>Take a screenshot of the output of the streaming_data_reader.py.</p><p>Name the screenshot <code>data_reader_output.jpg</code>. (Images can be saved with either the .jpg or .png extension.)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-28---health-check-of-the-streaming-data-pipeline">Task 2.8 - Health check of the streaming data pipeline.<a class="hash-link" href="#task-28---health-check-of-the-streaming-data-pipeline" title="Direct link to heading">​</a></h3><p>If you have done all the steps till here correctly, the streaming toll data would get stored in the table <code>livetolldata</code>.</p><p>List the top 10 rows in the table <code>livetolldata</code>.</p><p>Take a screenshot of the command and the output.</p><p>Name the screenshot <code>output_rows.jpg</code>. (Images can be saved with either the .jpg or .png extension.)</p><p>This concludes the assignment.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-04-09T13:34:30.000Z">Apr 9, 2023</time></b> by <b>sparsh</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#objective" class="table-of-contents__link toc-highlight">Objective</a></li><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#prepare-the-lab-environment" class="table-of-contents__link toc-highlight">Prepare the lab environment</a></li><li><a href="#assignment" class="table-of-contents__link toc-highlight">Assignment</a><ul><li><a href="#task-21---start-zookeeper" class="table-of-contents__link toc-highlight">Task 2.1 - Start Zookeeper</a></li><li><a href="#task-22---start-kafka-server" class="table-of-contents__link toc-highlight">Task 2.2 - Start Kafka server</a></li><li><a href="#task-23---create-a-topic-namedtoll" class="table-of-contents__link toc-highlight">Task 2.3 - Create a topic named <code>toll</code></a></li><li><a href="#task-24---configure-the-toll-traffic-simulator" class="table-of-contents__link toc-highlight">Task 2.4 - Configure the Toll Traffic Simulator</a></li><li><a href="#task-25---run-the-toll-traffic-simulator" class="table-of-contents__link toc-highlight">Task 2.5 - Run the Toll Traffic Simulator</a></li><li><a href="#task-26---configurethe-streaming-data-reader" class="table-of-contents__link toc-highlight">Task 2.6 - Configure the Streaming Data Reader</a></li><li><a href="#task-27---runthe-streaming-data-reader" class="table-of-contents__link toc-highlight">Task 2.7 - Run the Streaming Data Reader</a></li><li><a href="#task-28---health-check-of-the-streaming-data-pipeline" class="table-of-contents__link toc-highlight">Task 2.8 - Health check of the streaming data pipeline.</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Bootcamp. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.251db5a0.js"></script>
<script src="/assets/js/main.1462881d.js"></script>
</body>
</html>