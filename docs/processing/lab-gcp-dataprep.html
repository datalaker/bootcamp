<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-processing/lab-gcp-dataprep">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">GCP Dataprep | Recohut Data Bootcamp</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.recohut.com/docs/processing/lab-gcp-dataprep"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="data science, data engineering, data analytics"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="GCP Dataprep | Recohut Data Bootcamp"><meta data-rh="true" name="description" content="Creating a Data Transformation Pipeline with Cloud Dataprep"><meta data-rh="true" property="og:description" content="Creating a Data Transformation Pipeline with Cloud Dataprep"><link data-rh="true" rel="icon" href="/img/branding/favicon-black.svg"><link data-rh="true" rel="canonical" href="https://www.recohut.com/docs/processing/lab-gcp-dataprep"><link data-rh="true" rel="alternate" href="https://www.recohut.com/docs/processing/lab-gcp-dataprep" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.recohut.com/docs/processing/lab-gcp-dataprep" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Recohut Data Bootcamp RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Recohut Data Bootcamp Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B4S1B1ZDTT"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-B4S1B1ZDTT",{})</script><link rel="stylesheet" href="/assets/css/styles.e4e34528.css">
<link rel="preload" href="/assets/js/runtime~main.166317d0.js" as="script">
<link rel="preload" href="/assets/js/main.3580ce8c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/branding/favicon-color.svg" alt="Recohut Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/branding/favicon-color.svg" alt="Recohut Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Bootcamp</b></a><a class="navbar__item navbar__link" href="/docs/bootcamp">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/sparsh-ai/recohut" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/bootcamp">Recohut Data Bootcamps</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/foundations/developer-foundations/install-anaconda">foundations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/storage/apache-couchdb">storage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/processing/apache-beam">processing</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/apache-beam">Apache Beam</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/apache-druid">Druid</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/apache-flink">Apache Flink</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/apache-kafka">Apache Kafka</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/aws-emr">Amazon EMR</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/aws-kinesis">Kinesis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/aws-lambda-snippets">Snippets related to Lambda function</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/aws-lambda">AWS Lambda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/azure-synapse-analytics">Azure Synapse Analytics</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/processing/databricks">Databricks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Databricks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/dbt">dbt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/gcp-dataproc">Dataproc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/gcp-pubsub">Pub/Sub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-azure-hdinsight-simple-data-processing">Simple Data Pipeline with HDInsight</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-azure-synapse-data-processing">Processing Data Using Azure Synapse Analytics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-azure-synapse-dataflows">Transforming Data Using Azure Synapse Dataflows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-azure-synapse-implementing-star-schema">Implementing the Serving Layer Star Schema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-confluent-kafka-faker">Real-time CDC-enabled Extract and Load Pipeline with Kafka on Cloud</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-csv-to-parquet-conversion">CSV to Parquet Transformation with Glue Studio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-dataflow-bigquery-etl">ETL Processing on Google Cloud Using Dataflow and BigQuery</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/processing/lab-dbt-jaffle-shop">dbt Jaffle Shop</a><button aria-label="Toggle the collapsible sidebar category &#x27;dbt Jaffle Shop&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-dbt-knoema">Snowflake dbt Knoema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-dbt-nyctaxi">dbt NYC Taxi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-dbt-nyctaxi-lookup">NYC Taxi Analtics and ELT Pipeline with dbt and Postgres</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/processing/lab-dbt-olist">dbt Olist</a><button aria-label="Toggle the collapsible sidebar category &#x27;dbt Olist&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-dbt-stackexchnge">Stackexchange dbt Bigquery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-dbt-tickit">dbt Redshift TICKIT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-dbt-tpch">Snowflake dbt cloud TPCH</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-emr-serverless">EMR Serverless</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-gcp-beam-mapreduce">MapReduce in Beam using Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-gcp-dataflow-batch-pipeline">GCP Dataflow Batch Pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-gcp-dataflow-pipeline">GCP Dataflow Pipeline - A Simple Dataflow Pipeline (Python)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-gcp-dataflow-side-inputs">GCP Dataflow Size Inputs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-gcp-dataflow-stream-pipeline">GCP Dataflow Streaming Pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/processing/lab-gcp-dataprep">GCP Dataprep</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-gcp-dataproc">Running Apache Spark jobs on Cloud Dataproc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-gcp-pubsub-processing">Streaming Data Processing - Streaming Data Pipelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-gcp-pubsub">Streaming Data Processing - Publish Streaming Data into PubSub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-gcp-serverless-dataflow">GCP Serverless Dataflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-getting-started-with-beam">Apache Beam Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-glue-advanced">Advanced Data Engineering and Data Processing with AWS Glue Jobs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-glue-deltalake-cdc-upsert">Handle UPSERT data operations using open-source Delta Lake and AWS Glue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-glue-studio-custom-transforms">Glue Studio Custom Transforms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-glue-studio-tickets">Tickets ETL with Glue Studio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-kafka-cli">Getting started with Kafka and CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-kafka-fraud-detection">Real-time fraud detection by applying filter in Kafka topic</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/processing/lab-kafka-nyctaxi">Kafka Streams for NYC Taxi data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kafka Streams for NYC Taxi data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-kafka-python">Getting started with Kafka and Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-kafka-spark-streaming">Realtime Streaming analytics with Apache Kafka and Spark Streaming</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-kafka-stock-market">Stock Market Kafka Real Time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-kafka-toll-analysis">Data Streaming Pipeline with Kafka for livetolldata</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-kinesis-apache-logs">Real Time Apache Log Analytics with Kinesis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-kinesis-clickstream-anomaly">Real-Time Clickstream Anomaly Detection with Kinesis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-lambda-csv-parquet">Lambda CSV to Parquet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-ray-air-basics">Lab: Ray AIR Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-ray-core-basics">Lab: Ray Core Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-snowpark-churnpark">Churn Analytics Demo with dbt Snowpark Python models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-snowpark-dbtsnowpy">Modeling with dbt and Snowpark</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-snowpark-fifapark">FIFA modeling with Snowpark</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/processing/lab-snowpark-jafflepark">Jaffle Shop Modeling with Snowpark</a><button aria-label="Toggle the collapsible sidebar category &#x27;Jaffle Shop Modeling with Snowpark&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/lab-snowpark-knoema-regression">Knoema Regression Model with Snowpark</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/project-kafka-ikea">Building an event-driven IKEA app with Kafka</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/ray">Ray</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/processing/snowpark">Snowpark</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/data-modeling/3nf-data-modeling">data-modeling</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/extraction">Data Extraction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Data Extraction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/orchestration">Orchestration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Orchestration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/devops">DevOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/visualization">Visualization</a><button aria-label="Toggle the collapsible sidebar category &#x27;Visualization&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/datascience/algorithms/decision-trees">datascience</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/assignments">Assignments</a><button aria-label="Toggle the collapsible sidebar category &#x27;Assignments&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/capstones">Capstones</a><button aria-label="Toggle the collapsible sidebar category &#x27;Capstones&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/mlops">MLOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;MLOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/a1-interviewprep">Interview Preparation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Interview Preparation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/a3-casestudies">Case Studies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Case Studies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/b3-misc/explore-further">b3-misc</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/mathematics">Mathematics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Mathematics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">processing</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">GCP Dataprep</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>GCP Dataprep</h1><blockquote><p>Creating a Data Transformation Pipeline with Cloud Dataprep</p></blockquote><p><img loading="lazy" src="https://user-images.githubusercontent.com/62965911/214003279-5d213b3a-935f-4f7a-b652-372bd7a967a2.png" class="img_ev3q"></p><p>Cloud Dataprep by Alteryx is an intelligent data service for visually exploring, cleaning, and preparing structured and unstructured data for analysis. In this lab you explore the Cloud Dataprep UI to build a data transformation pipeline that outputs results into BigQuery.</p><p>The dataset you&#x27;ll use is an <a href="https://www.en.advertisercommunity.com/t5/Articles/Introducing-the-Google-Analytics-Sample-Dataset-for-BigQuery/ba-p/1676331#" target="_blank" rel="noopener noreferrer">ecommerce dataset</a> that has millions of Google Analytics session records for the Google Merchandise Store loaded into BigQuery. You have a copy of that dataset for this lab and will explore the available fields and row for insights.</p><p>In this lab, you will learn how to perform these tasks:</p><ul><li>Connect BigQuery datasets to Cloud Dataprep</li><li>Explore dataset quality with Cloud Dataprep</li><li>Create a data transformation pipeline with Cloud Dataprep</li><li>Run transformation jobs outputs to BigQuery</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-enable-dataprep">Step 1: Enable DataPrep<a class="hash-link" href="#step-1-enable-dataprep" title="Direct link to heading">​</a></h3><p>Search for DataPrep in GCP console search box and go to the DataPrep product page. Access and enable the product.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-creating-a-bigquery-dataset">Step 2: Creating a BigQuery dataset<a class="hash-link" href="#step-2-creating-a-bigquery-dataset" title="Direct link to heading">​</a></h3><p>You need BigQuery as an endpoint for dataset ingestion to the pipeline and as a destination for the output when the pipeline is completed.</p><ol><li>Search for BigQuery in GCP console search box and Go to BigQuery</li><li>In the left pane, under Explorer section, click on the View actions icon to the right of your project ID, then click Create dataset.</li><li>For Dataset ID, type <code>ecommerce</code>.</li><li>Leave the other values at their defaults.</li><li>Click CREATE DATASET. You will now see your dataset under your project in the left pane.</li><li>Copy and paste the following SQL query into the Query Editor:<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#standardSQL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLACE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> ecommerce</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">all_sessions_raw_dataprep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OPTIONS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Raw data from analyst team to ingest into Cloud Dataprep&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">data-to-insights.ecommerce.all_sessions_raw</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">date</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;20170801&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># limiting to one day of data 56k rows for this lab</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li>Click RUN. This query copies over a subset of the public raw ecommerce dataset (one day&#x27;s worth of session data, or about 56 thousand records) into a new table named <code>all_sessions_raw_dataprep</code>, which has been added to your ecommerce dataset for you to explore and clean in Cloud Dataprep.</li><li>Confirm that the new table exists in your <code>ecommerce</code> dataset</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-connecting-bigquery-data-to-cloud-dataprep">Step 3: Connecting BigQuery data to Cloud Dataprep<a class="hash-link" href="#step-3-connecting-bigquery-data-to-cloud-dataprep" title="Direct link to heading">​</a></h3><p>In this step, you will connect Cloud Dataprep to your BigQuery data source. On the Cloud Dataprep page:</p><ol><li>Click Create a new flow in the left corner.</li><li>Rename the Untitled Flow and specify these details:<ol><li>For Flow Name, type <code>Ecommerce Analytics Pipeline</code></li><li>For Flow Description, type <code>Revenue reporting table</code></li></ol></li><li>Click Ok.</li><li>If prompted with a <code>What&#x27;s a flow?</code> popup, select Don&#x27;t show me any helpers.</li><li>Click the Add Icon in the Dataset box.</li><li>In the Add Datasets to Flow dialog box, select Import Datasets.</li><li>In the left pane, click BigQuery.</li><li>When your ecommerce dataset is loaded, click on it.</li><li>Click on the Create dataset icon (+ sign) on the left of the <code>all_sessions_raw_dataprep</code> table.</li><li>Click Import &amp; Add to Flow in the bottom right corner.</li></ol><p>The data source automatically updates. You are ready to go to the next step.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-exploring-ecommerce-data-fields-with-the-ui">Step 4: Exploring ecommerce data fields with the UI<a class="hash-link" href="#step-4-exploring-ecommerce-data-fields-with-the-ui" title="Direct link to heading">​</a></h3><p>In this step, you will load and explore a sample of the dataset within Cloud Dataprep.</p><ol><li>Click the Recipe icon and then select Edit Recipe.</li><li>Cloud Dataprep loads a sample of your dataset into the Transformer view. This process might take a few seconds. You are now ready to start exploring the data!</li></ol><p>Answer the following questions:</p><ol><li>How many columns are there in the dataset?<ol><li>Answer: 32 columns.</li></ol></li><li>How many rows does the sample contain?<ol><li>Answer: About 12 thousand rows.</li></ol></li><li>What is the most common value in the <code>channelGrouping</code> column?<ol><li>Hint: Find out by hovering your mouse cursor over the histogram under the <code>channelGrouping</code> column title.</li><li>Answer: Referral.</li><li>Note: A <a href="https://support.google.com/analytics/answer/1011811?hl=en" target="_blank" rel="noopener noreferrer">referring site</a> is typically any other website that has a link to your content. An example here is a different website reviewed a product on our ecommerce website and linked to it. This is considered a different acquisition channel than if the visitor came from a search engine.</li></ol></li><li>What are the top three countries from which sessions are originated?<ol><li>Answer: United States, India, United Kingdom</li></ol></li><li>What does the grey bar under totalTransactionRevenue represent?<ol><li>Answer: Missing values for the <code>totalTransactionRevenue</code> field.</li><li>This means that a lot of sessions in this sample did not generate revenue. Later, we will filter out these values so our final table only has customer transactions and associated revenue.</li></ol></li><li>What is the maximum <code>timeOnSite</code> in seconds, maximum <code>pageviews</code>, and maximum <code>sessionQualityDim</code> for the data sample?<ol><li>Hint: Open the menu to the right of the <code>timeOnSite</code> column by clicking the Column Details menu</li><li>To close the details window, click the Close Column Details (X) button in the top right corner. Then repeat the process to view details for the <code>pageviews</code> and <code>sessionQualityDim</code> columns.</li><li>Answers:<ol><li>Maximum Time On Site: 5,561 seconds (or 92 minutes)</li><li>Maximum Pageviews: 155 pages</li><li>Maximum Session Quality Dimension: 97</li></ol></li><li>Note: Your answers for maximums may vary slightly due to the data sample used by Cloud Dataprep.</li><li>Note on averages: Use extra caution when performing aggregations like averages over a column of data. We need to first ensure fields like <code>timeOnSite</code> are only counted once per session. We&#x27;ll explore the uniqueness of visitor and session data in a later lab.</li></ol></li><li>Looking at the histogram for <code>sessionQualityDim</code>, are the data values evenly distributed?<ol><li>Answer: No, they are skewed to lower values (low quality sessions), which is expected.</li></ol></li><li>What is the date range for the dataset? Hint: Look at date field<ol><li>Answer: 8/1/2017 (one day of data)</li></ol></li><li>You might see a red bar under the <code>productSKU</code> column. If so, what might that mean?<ol><li>Answer: A red bar indicates mismatched values.</li><li>While sampling data, Cloud Dataprep attempts to automatically identify the type of each column. If you do not see a red bar for the <code>productSKU</code> column, then this means that Cloud Dataprep correctly identified the type for the column (i.e. the String type). If you do see a red bar, then this means that Cloud Dataprep found enough number values in its sampling to determine (incorrectly) that the type should be Integer. Cloud Dataprep also detected some non-integer values and therefore flagged those values as mismatched. In fact, the <code>productSKU</code> is not always an integer (for example, a correct value might be &quot;GGOEGOCD078399&quot;). So in this case, Cloud Dataprep incorrectly identified the column type: it should be a string, not an integer. You will fix that later in this lab.</li></ol></li><li>Looking at the <code>v2ProductName</code> column, what are the most popular products?<ol><li>Answer: Nest products</li></ol></li><li>Looking at the <code>v2ProductCategory</code> column, what are some of the most popular product categories?<ol><li>Answers: The most popular product categories are: Nest, Bags, (not set) (which means that some sessions are not associated with a category)</li></ol></li><li>True or False? The most common <code>productVariant</code> is <code>COLOR</code>.<ol><li>Answer: False. It&#x27;s (not set) because most products do not have variants (80%+)</li></ol></li><li>What are the two values in the type column?<ol><li>Answer: <code>PAGE</code> and <code>EVENT</code></li><li>A user can have many different interaction types when browsing your website. Types include recording session data when viewing a PAGE or a special EVENT (like &quot;clicking on a product&quot;) and other types. Multiple hit types can be triggered at the exact same time so you will often filter on type to avoid double counting. We&#x27;ll explore this more in a later analytics lab.</li></ol></li><li>What is the maximum <code>productQuantity</code>?<ol><li>Answer: 100 (your answer may vary)</li><li><code>productQuantity</code> indicates how many units of that product were added to cart. 100 means 100 units of a single product was added.</li></ol></li><li>What is the dominant <code>currencyCode</code> for transactions?<ol><li>Answer: USD (United States Dollar)</li></ol></li><li>Are there valid values for <code>itemQuantity</code> or <code>itemRevenue</code>?<ol><li>Answer: No, they are all <code>NULL</code> (or missing) values.</li><li>Note: After exploration, in some datasets you may find duplicative or deprecated columns. We will be using <code>productQuantity</code> and <code>productRevenue</code> fields instead and dropping the <code>itemQuantity</code> and <code>itemRevenue</code> fields later in this lab to prevent confusion for our report users.</li></ol></li><li>What percentage of <code>transactionId</code> values are valid? What does this represent for our <code>ecommerce</code> dataset?<ol><li>Answer: About 4.6% of transaction IDs have a valid value, which represents the average conversion rate of the website (4.6% of visitors transact).</li></ol></li><li>How many <code>eCommerceAction_type</code> values are there, and what is the most common value?<ol><li>Hint: Count the distinct number of histogram columns.</li><li>Answers: There are seven values found in our sample. The most common value is zero <code>0</code> which indicates that the type is unknown. This makes sense as the majority of the web sessions on our website will not perform any ecommerce actions as they are just browsing.</li></ol></li><li>Using the <a href="https://support.google.com/analytics/answer/3437719?hl=en" target="_blank" rel="noopener noreferrer">schema</a>, what does <code>eCommerceAction_type = 6</code> represent?<ol><li>Hint: Search for <code>eCommerceAction</code> type and read the description for the mapping</li><li>Answer: 6 maps to &quot;Completed purchase&quot;. Later in this lab we will ingest this mapping as part of our data pipeline.</li></ol></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-cleaning-the-data">Step 5: Cleaning the data<a class="hash-link" href="#step-5-cleaning-the-data" title="Direct link to heading">​</a></h3><p>In this task, you will clean the data by deleting unused columns, eliminating duplicates, creating calculated fields, and filtering out unwanted rows.</p><p><strong>Converting the productSKU column data type</strong></p><ol><li>To ensure that the productSKU column type is a string data type, open the menu to the right of the productSKU column by clicking, then click Change type &gt; String.</li><li>Verify that the first step in your data transformation pipeline was created by clicking on the Recipe icon:</li></ol><p><strong>Deleting unused columns</strong></p><p>As we mentioned earlier, we will be deleting the itemQuantity and itemRevenue columns as they only contain NULL values and are not useful for the purpose of this lab.</p><ol><li>Open the menu for the itemQuantity column, and then click Delete.</li><li>Repeat the process to delete the itemRevenue column.</li></ol><p><strong>Deduplicating rows</strong></p><p>Your team has informed you there may be duplicate session values included in the source dataset. Let&#x27;s remove these with a new deduplicate step.</p><ol><li>Click the Filter rows icon in the toolbar, then click Remove duplicate rows.</li><li>Click Add in the right-hand panel.</li></ol><p><strong>Filtering out sessions without revenue</strong></p><p>Your team has asked you to create a table of all user sessions that bought at least one item from the website. Filter out user sessions with NULL revenue.</p><ol><li>Under the totalTransactionRevenue column, click the grey Missing values bar. All rows with a missing value for totalTransactionRevenue are now highlighted in red.</li><li>In the Suggestions panel, in Delete rows, click Add.</li></ol><p>This step filters your dataset to only include transactions with revenue (where totalTransactionRevenue is not NULL).</p><p><strong>Filtering sessions for PAGE views</strong></p><p>The dataset contains sessions of different types, for example PAGE (for page views) or EVENT (for triggered events like &quot;viewed product categories&quot; or &quot;added to cart&quot;). To avoid double counting session pageviews, add a filter to only include page view related hits.</p><ol><li>In the histogram below the type column, click the bar for PAGE. All rows with the type PAGE are now highlighted in green.</li><li>In the Suggestions panel, in Keep rows, and click Add.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-6-enriching-the-data">Step 6: Enriching the data<a class="hash-link" href="#step-6-enriching-the-data" title="Direct link to heading">​</a></h3><p>Search your <a href="https://support.google.com/analytics/answer/3437719?hl=en/" target="_blank" rel="noopener noreferrer">schema documentation</a> for visitId and read the description to determine if it is unique across all user sessions or just the user.</p><ul><li><code>visitId</code>: an identifier for this session. This is part of the value usually stored as the <code>utmb</code> cookie. This is only unique to the user. For a completely unique ID, you should use a combination of fullVisitorId and visitId.</li></ul><p>As we see, <code>visitId</code> is not unique across all users. We will need to create a unique identifier.</p><p><strong>Creating a new column for a unique session ID</strong></p><p>As you discovered, the dataset has no single column for a unique visitor session. Create a unique ID for each session by concatenating the fullVisitorID and visitId fields.</p><ol><li>Click on the Merge columns icon in the toolbar.</li><li>For Columns, select <code>fullVisitorId</code> and <code>visitId</code>.</li><li>For Separator type a single hyphen character: <code>-</code>.</li><li>For the New column name, type <code>unique_session_id</code>.</li><li>Click Add.</li></ol><p>The <code>unique_session_id</code> is now a combination of the <code>fullVisitorId</code> and <code>visitId</code>. We will explore in a later lab whether each row in this dataset is at the unique session level (one row per user session) or something even more granular.</p><p><strong>Creating a case statement for the ecommerce action type</strong></p><p>As you saw earlier, values in the <code>eCommerceAction_type</code> column are integers that map to actual ecommerce actions performed in that session. For example, 3 = &quot;Add to Cart&quot; or 5 = &quot;Check out&quot;. This mapping will not be immediately apparent to our end users so let&#x27;s create a calculated field that brings in the value name.</p><ol><li>Click on Conditions in the toolbar, then click <code>Case on single column</code>.</li><li>For Column to evaluate, specify <code>eCommerceAction_type</code>.</li><li>Next to Cases (1), click Add 8 times for a total of 9 cases.</li><li>For each Case, specify the following mapping values (including the single quote characters):
| Comparison | New value                          |
| ---------- | ---------------------------------- |
| <code>0</code>        | <code>&#x27;Unknown&#x27;</code>                        |
| <code>1</code>        | <code>&#x27;Click through of product lists&#x27;</code> |
| <code>2</code>        | <code>&#x27;Product detail views&#x27;</code>           |
| <code>3</code>        | <code>&#x27;Add product(s) to cart&#x27;</code>         |
| <code>4</code>        | <code>&#x27;Remove product(s) from cart&#x27;</code>    |
| <code>5</code>        | <code>&#x27;Check out&#x27;</code>                      |
| <code>6</code>        | <code>&#x27;Completed purchase&#x27;</code>             |
| <code>7</code>        | <code>&#x27;Refund of purchase&#x27;</code>             |
| <code>8</code>        | <code>&#x27;Checkout options&#x27;</code>               |</li><li>For New column name, type <code>eCommerceAction_label</code>. Leave the other fields at their default values.</li><li>Click Add.</li></ol><p><strong>Adjusting values in the totalTransactionRevenue column</strong></p><p>As mentioned in the <a href="https://support.google.com/analytics/answer/3437719?hl=en" target="_blank" rel="noopener noreferrer">schema</a>, the totalTransactionRevenue column contains values passed to Analytics multiplied by 10^6 (e.g., 2.40 would be given as 2400000). You now divide the contents of that column by 10^6 to get the original values.</p><ol><li>Open the menu to the right of the totalTransactionRevenue column by clicking the dropdown arrow, then select Calculate &gt; Custom formula.</li><li>For Formula, type: <code>DIVIDE(totalTransactionRevenue,1000000)</code> and for New column name, type: <code>totalTransactionRevenue1</code>. Notice the preview for the transformation.</li><li>Click Add.</li><li>Note: You might see a red bar under the <code>totalTransactionRevenue1</code> column. Open the menu to the right of the <code>totalTransactionRevenue1</code> column, then click Change type &gt; Decimal.</li><li>Review the full list of steps in your recipe.</li><li>You can now click Run.</li></ol><p><img loading="lazy" src="https://user-images.githubusercontent.com/62965911/214003293-f447729f-e008-4742-a04e-58aa0281189a.png" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-7-running-cloud-dataprep-jobs-to-bigquery">Step 7: Running Cloud Dataprep jobs to BigQuery<a class="hash-link" href="#step-7-running-cloud-dataprep-jobs-to-bigquery" title="Direct link to heading">​</a></h3><ol><li>In the Run Job page, select Dataflow for your Running Environment.</li><li>Under Publishing Actions, click on Edit on the right of Create-CSV.</li><li>In the following page, select BigQuery from the left hand menu.</li><li>Select your ecommerce dataset.</li><li>Click Create a New Table from the panel on the right.</li><li>Name your table revenue_reporting.</li><li>Select Drop the Table every run.</li><li>Click on Update.</li><li>Click RUN.</li></ol><p>Once your Cloud Dataprep job is completed, refresh your BigQuery page and confirm that the output table revenue_reporting exists.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/62965911/214003287-a54770f5-76bc-4953-b1c9-9564fee171a6.png" class="img_ev3q"></p><p><img loading="lazy" src="https://user-images.githubusercontent.com/62965911/214003160-35926333-1eb8-4493-b6c1-9ea64c46e20a.png" class="img_ev3q"></p><p>Note: If your job fails, try waiting a minute, pressing the back button on your browser, and running the job again with the same settings.</p><p>Congratulations!</p><p>You&#x27;ve successfully explored your ecommerce dataset and created a data transformation pipeline with Cloud Dataprep.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-04-09T13:34:30.000Z">Apr 9, 2023</time></b> by <b>sparsh</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/processing/lab-gcp-dataflow-stream-pipeline"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">GCP Dataflow Streaming Pipeline</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/processing/lab-gcp-dataproc"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Running Apache Spark jobs on Cloud Dataproc</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#step-1-enable-dataprep" class="table-of-contents__link toc-highlight">Step 1: Enable DataPrep</a></li><li><a href="#step-2-creating-a-bigquery-dataset" class="table-of-contents__link toc-highlight">Step 2: Creating a BigQuery dataset</a></li><li><a href="#step-3-connecting-bigquery-data-to-cloud-dataprep" class="table-of-contents__link toc-highlight">Step 3: Connecting BigQuery data to Cloud Dataprep</a></li><li><a href="#step-4-exploring-ecommerce-data-fields-with-the-ui" class="table-of-contents__link toc-highlight">Step 4: Exploring ecommerce data fields with the UI</a></li><li><a href="#step-5-cleaning-the-data" class="table-of-contents__link toc-highlight">Step 5: Cleaning the data</a></li><li><a href="#step-6-enriching-the-data" class="table-of-contents__link toc-highlight">Step 6: Enriching the data</a></li><li><a href="#step-7-running-cloud-dataprep-jobs-to-bigquery" class="table-of-contents__link toc-highlight">Step 7: Running Cloud Dataprep jobs to BigQuery</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Bootcamp. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.166317d0.js"></script>
<script src="/assets/js/main.3580ce8c.js"></script>
</body>
</html>